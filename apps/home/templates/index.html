{% extends 'base.html' %}
{% load static %}


{% block meta %}
    <meta name="keywords" content="python+django搭建自己的博客,搭建博客" charset="utf-8"/>
    <meta name="description" content=" python+django搭建自己的博客,搭建博客" charset="utf-8"/>
{% endblock %}

{% block content %}
    <div class="blog row" data-scroll-reveal="enter top">
        {% for figure_article in figure_articles  %}
            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
{#                <figure id="my-figure" >#}
                    <ul style="padding: 0;">
                        <img class='article-figure' id="image-{{ figure_article.article_id }}" title="{{ figure_article.title }}" style="border-radius:4px; width: 100%; height: 100%" src="/static/images/loading.gif">
                        <a href="/articles/p/{{ figure_article.article_id }}.html"></a>
                    </ul>
                    <p style="text-align: center">
                        <a href="/articles/p/{{ figure_article.article_id }}.html" style="color: rgba(52, 73, 94, 0.94); font-weight: bolder; font-size: 14px">
                            {{ figure_article.title }}
                        </a>
                    </p>
                    <span class="article-description">
                        {{ figure_article.description }}
                    </span>
{#                </figure>#}
            </div>
        {% endfor %}
    </div>

    <div style="margin-top: 24px; ">
        <ul class="article-list">
            {% for article in articles %}
                {% include "article_list.html" %}
            {% endfor %}
        </ul>
    </div>
    <div class="pages">
        <a class="prev-page"><</a>
        <a class="next-page">></a>
        <label id="total-pages" style="margin-left: 0; margin-top: 6px">共{{total_pages}}页</label>
    </div>

    <script>
        var screenWidth = getWidth();
        console.log("screenWidth=" + screenWidth)
        let totalPages = parseInt({{ total_pages }});
        let curPage = parseInt({{ page }})

        /*分页处理太麻烦了，简单粗暴的方法往往更有效*/
        let idx = 1
        if (curPage <= 10) {
            idx = 1
        } else if (curPage <= 21) {
            idx = 11
        } else if (curPage <= 31) {
            idx = 21
        }
        for (let i = idx; i <= totalPages && i < idx + 10; i++) {
            let obj = $('<a href="#">' + i + '</a>').insertBefore($('.next-page'))
            console.log(obj.text())
            if (i === curPage) {
                obj.addClass('active');
            }
            obj.attr('href', '/?page=' + i)
        }

        if (curPage === 1) {
            $('.prev-page').addClass('hidden')
        } else if (curPage === totalPages) {
            $('.next-page').addClass('hidden')
        }
        $('.pages > a').unbind('click').click(function (){
            let text = $(this).text()
            if (text === '<') {
                window.location.href = "/?page=" + (curPage - 1)
            } else if (text === '>') {
                window.location.href = "/?page=" + (curPage + 1)
            } else {
                let pageId = parseInt($(this).text());
            }
        })
        $(document).ready(function(){
            $(".article-figure").each(function() {
                {#所有的图标都是3*5#}
                image_download_and_set($(this).attr("id"), "/articles/d_icon/?title=" + $(this).attr("title"))
                let width =$(this).width()
                $(this).height(width * 3 / 5)
            })
        })
    </script>
{% endblock %}



